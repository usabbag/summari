javascript:(function(){function e(){return window.location.href}function t(){return document.body.innerText}function n(){const e=document.createElement("div");e.id="summaryLoader",e.style.cssText="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#007311;color:white;padding:20px;border-radius:10px;z-index:10001;font-family:Arial,sans-serif;",e.textContent="Summarizing...",document.body.appendChild(e)}function o(){const e=document.getElementById("summaryLoader");e&&document.body.removeChild(e)}function r(e,t){if(!document.getElementById("summaryModal")){const n=document.createElement("div");n.id="summaryModal",n.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;z-index:10000;font-family:-apple-system,system-ui,sans-serif;";const o=document.createElement("div");o.style.cssText="background-color:#fff;padding:24px;border-radius:12px;width:600px;max-width:90%;max-height:80vh;overflow-y:auto;font-size:16px;line-height:1.5;box-shadow:0 4px 12px rgba(0,0,0,0.15);",o.innerHTML=`<h2 style="margin:0 0 16px;font-size:20px;color:#1f2937">Summary</h2><p style="margin:0 0 16px;font-size:14px;color:#4b5563"><strong>Source: ${t}</strong></p><p style="margin:0;font-size:18px;color:#1f2937">${e}</p><button id="closeModal" style="margin-top:20px;padding:8px 16px;background:#007311;color:white;border:none;border-radius:6px;cursor:pointer">Close</button>`,n.appendChild(o),document.body.appendChild(n),document.getElementById("closeModal").addEventListener("click",()=>{document.body.removeChild(n)})}}function i(){let e=localStorage.getItem("openai_api_key");return e||((e=prompt("Please enter your OpenAI API key"))&&localStorage.setItem("openai_api_key",e)),e}async function a(e,t){const n=i();if(!n)throw new Error("API key required");const o=await fetch("https://ulysse-bookmarkdigest.web.val.run",{method:"POST",headers:{"Content-Type":"application/json","X-OpenAI-Key":n},body:JSON.stringify({url:e,text:t}),mode:"cors"});if(!o.ok){if(401===o.status)throw localStorage.removeItem("openai_api_key"),new Error("Invalid API key");throw new Error(`HTTP error! status: ${o.status}`)}return(await o.json()).summary}async function s(){const i=e();n();try{const e=await a(i);o(),r(e,"URL")}catch(e){console.error("Error:",e);try{const e=t(),i=await a(null,e);o(),r(i,"Page Text")}catch(e){console.error("Error:",e),o(),alert("Failed to summarize the page. Please try again later.")}}}s()})();