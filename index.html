<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summariz.io - AI Summaries in a Bookmarklet</title>
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
    <div class="container">
        <div class="hero">
            <div class="hero-content">
                <div class="title-with-logo">
                    <img src="assets/summarizio.png" alt="Summarizio Logo" class="logo">
                    <h1>Summariz.io</h1>
                </div>
                <p class="tagline">Dense AI summaries, one click away</p>

                <div id="setupContainer">
                    <form id="setupForm">
                        <input
                            type="text"
                            id="apiKey"
                            placeholder="Your Anthropic API Key"
                            required
                        >
                        <button type="submit" class="bookmarklet">
                            Generate
                        </button>
                    </form>
                </div>

                <div id="bookmarkletContainer" style="display: none;">
                    <a id="bookmarklet" class="bookmarklet">
                        +Summarize
                    </a>
                    <small class="install-note" style="display: none;">
                        <span class="desktop-only">Drag to your bookmarks bar</span>
                        <a href="#quick-setup" class="mobile-only">On mobile? Tap for instructions</a>
                    </small>
                    <div class="reset-note">
                        <button onclick="copyGeneratedBookmarklet()" class="mobile-copy-button">
                            Copy Code
                        </button>
                        <button id="resetBookmarklet">
                            Reset
                        </button>
                    </div>
                </div>

            </div>

            <div class="hero-setup">
                <h2>
                    Setup
                    <div class="toggle-container">
                        <button class="toggle-button active" data-target="desktop-setup">Desktop</button>
                        <button class="toggle-button" data-target="mobile-setup">iOS</button>
                    </div>
                </h2>

                <div id="desktop-setup" class="setup-content active">
                    <ol class="steps">
                        <li>Get a <a href="https://console.anthropic.com/" target="_blank">new Anthropic API key</a></li>
                        <li>Enter your API key above and click "Generate"</li>
                        <li>Drag the Summarize button to your bookmarks bar</li>
                    </ol>
                </div>

                <div id="mobile-setup" class="setup-content">
                    <ol class="steps">
                        <li>Get a <a href="https://console.anthropic.com/" target="_blank">new Anthropic API key</a></li>
                        <li>Enter your API key above and tap "Generate"</li>
                        <li>Copy the bookmarklet code using the button</li>
                        <li>Add a new bookmark in Safari and paste the code as the URL</li>
                    </ol>
                </div>
            </div>

            <div class="section">
                <div class="features-grid">
                    <div class="feature">
                        <h3>One Click, Anywhere</h3>
                        <p>Works on any browser or device. No apps, accounts, or installations. Just the simplicity of bookmarklets.</p>
                    </div>
                    <div class="feature">
                        <h3>Powered by Claude</h3>
                        <p>Dense 200-word summaries via <a href="https://www.anthropic.com/claude" target="_blank">Claude Sonnet 4.5</a>. Clear, comprehensive, no bullet points.</p>
                    </div>
                    <div class="feature">
                        <h3>Smart Extraction</h3>
                        <p>Summarizes via URL first, falls back to page text. Works even on paywalled or dynamic content.</p>
                    </div>
                    <div class="feature">
                        <h3>Private & At Cost</h3>
                        <p>Direct API calls through your Anthropic account. No middleman, no markups, no subscriptions.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <footer>
        Made by <a href="https://harsa.inc">Harsa</a>
    </footer>
    <script>
    function isMobile() {
        return window.matchMedia('(max-width: 768px)').matches;
    }

    document.addEventListener('DOMContentLoaded', () => {
        if (isMobile()) {
            const mobileButton = document.querySelector('[data-target="mobile-setup"]');
            const mobileContent = document.getElementById('mobile-setup');
            const desktopButton = document.querySelector('[data-target="desktop-setup"]');
            const desktopContent = document.getElementById('desktop-setup');

            mobileButton.classList.add('active');
            mobileContent.classList.add('active');
            desktopButton.classList.remove('active');
            desktopContent.classList.remove('active');
        }
    });

    document.querySelectorAll('.toggle-button').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelectorAll('.toggle-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.setup-content').forEach(c => c.classList.remove('active'));

            button.classList.add('active');
            document.getElementById(button.dataset.target).classList.add('active');
        });
    });

    document.addEventListener('DOMContentLoaded', function() {
        const hasBookmarklet = localStorage.getItem('hasBookmarklet');
        if (hasBookmarklet) {
            document.getElementById('setupContainer').style.display = 'none';
            document.getElementById('bookmarkletContainer').style.display = 'block';
        }
    });

    document.getElementById('resetBookmarklet').addEventListener('click', function(e) {
        e.preventDefault();
        localStorage.removeItem('hasBookmarklet');
        document.getElementById('setupContainer').style.display = 'block';
        document.getElementById('bookmarkletContainer').style.display = 'none';
        document.getElementById('apiKey').value = '';
    });

    document.getElementById('setupForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const apiKey = document.getElementById('apiKey').value;

        if (!apiKey.startsWith('sk-ant-')) {
            alert('Please enter a valid Anthropic API key starting with "sk-ant-"');
            return;
        }

        const encodedKey = btoa(apiKey);

        const bookmarkletCode = `javascript:(function(){function e(){return window.location.href}function t(){return document.body.innerText}function n(){const e=document.createElement("div");e.id="summaryLoader",e.style.cssText="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#d95a1b;color:white;padding:20px;border-radius:12px;z-index:10001;font-family:-apple-system,system-ui,sans-serif;font-size:16px;box-shadow:0 4px 20px rgba(0,0,0,0.15);",e.textContent="Summarizing...",document.body.appendChild(e)}function o(){const e=document.getElementById("summaryLoader");e&&document.body.removeChild(e)}function r(e,t){if(!document.getElementById("summaryModal")){const n=document.createElement("div");n.id="summaryModal",n.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.4);display:flex;align-items:center;justify-content:center;z-index:10000;font-family:-apple-system,system-ui,sans-serif;backdrop-filter:blur(4px);";const o=document.createElement("div");o.style.cssText="background-color:#fffcf9;padding:28px;border-radius:16px;width:560px;max-width:90%;max-height:80vh;overflow-y:auto;font-size:16px;line-height:1.6;box-shadow:0 8px 32px rgba(0,0,0,0.12);color:#2d2a26;",o.innerHTML=\`<h2 style="margin:0 0 12px;font-size:22px;font-weight:500;color:#2d2a26">Summary</h2><p style="margin:0 0 16px;font-size:13px;color:#6b6560">Source: \${t}</p><p style="margin:0;font-size:17px;color:#2d2a26;line-height:1.65">\${e}</p><button id="closeModal" style="margin-top:24px;padding:10px 20px;background:#d95a1b;color:white;border:none;border-radius:8px;cursor:pointer;font-size:15px;font-weight:500;transition:background 0.2s">Close</button>\`,n.appendChild(o),document.body.appendChild(n),document.getElementById("closeModal").addEventListener("click",()=>{document.body.removeChild(n)}),document.getElementById("closeModal").addEventListener("mouseenter",function(){this.style.background="#b84a15"}),document.getElementById("closeModal").addEventListener("mouseleave",function(){this.style.background="#d95a1b"})}}function i(){return atob('${encodedKey}')}async function a(e,t){const n=i();if(!n)throw new Error("API key required");const o=await fetch("https://summari-worker.ulysse.workers.dev",{method:"POST",headers:{"Content-Type":"application/json","X-Anthropic-Key":n},body:JSON.stringify({url:e,text:t}),mode:"cors"});if(!o.ok){if(401===o.status)throw new Error("Invalid API key");throw new Error(\`HTTP error! status: \${o.status}\`)}return(await o.json()).summary}async function s(){const i=e();n();try{const e=await a(i);o(),r(e,"URL")}catch(e){console.error("Error:",e);try{const e=t(),i=await a(null,e);o(),r(i,"Page Text")}catch(e){console.error("Error:",e),o(),alert("Failed to summarize the page. Please try again later.")}}}s()})()`;

        const bookmarklet = document.getElementById('bookmarklet');
        bookmarklet.href = bookmarkletCode;

        document.getElementById('setupContainer').style.display = 'none';
        document.getElementById('bookmarkletContainer').style.display = 'block';
        localStorage.setItem('hasBookmarklet', 'true');
        document.querySelector('.install-note').style.display = 'block';
    });

    function copyGeneratedBookmarklet() {
        const bookmarkletCode = document.getElementById('bookmarklet').href;
        navigator.clipboard.writeText(bookmarkletCode).then(() => {
            const button = document.querySelector('.mobile-copy-button');
            button.textContent = 'Copied!';
            setTimeout(() => {
                button.textContent = 'Copy Code';
            }, 2000);
        });
    }
    </script>
</body>
</html>
